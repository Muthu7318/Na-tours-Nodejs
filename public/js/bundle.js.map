{"version":3,"sources":["index.js"],"names":["formElement","document","querySelector","logOutBtn","userData","userPasswordForm","addEventListener","e","preventDefault","email","getElementById","value","password","login","formData","axios","method","url","data","withCredentials","res","status","showAlert","window","setTimeout","location","assign","console","log","response","message","logOut","type","hideAlert","markup","insertAdjacentHTML","el","parentElement","removeChild","form","FormData","append","files","updateSettings","textContent","passwordCurrent","passwordConfirm","userInfoObj","reload"],"mappings":"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","file":"bundle.js","sourceRoot":"","sourcesContent":["/* eslint-disable */\r\nconst formElement = document.querySelector('.form--login');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userData = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-settings');\r\n\r\nif (formElement) {\r\n  formElement.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    // let myForm = document.getElementById('form');\r\n    // let formData = new FormData(myForm);\r\n    // console.log(formData);\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nconst login = async (email, password, formData) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: 'http://127.0.0.1:3000/api/v1/users/login',\r\n      data: {\r\n        email: email,\r\n        password: password,\r\n      },\r\n      // data: formData,\r\n      withCredentials: true,\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', 'Username and Password is incorrect');\r\n    console.log(err.response.data.message);\r\n  }\r\n};\r\n\r\nasync function logOut() {\r\n  console.log('logout');\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: 'http://127.0.0.1:3000/api/v1/users/logout',\r\n    });\r\n    if (res.data.status === 'success') {\r\n      location.assign('/');\r\n    }\r\n  } catch (err) {\r\n    console.log(err.response);\r\n    showAlert('error', 'Error Logging out. Try again');\r\n  }\r\n}\r\n\r\nif (logOutBtn) {\r\n  logOutBtn.addEventListener('click', logOut);\r\n}\r\n\r\nconst showAlert = (type, message) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${message}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n\r\nconst hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) {\r\n    el.parentElement.removeChild(el);\r\n  }\r\n};\r\n\r\nif (userData) {\r\n  userData.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const form = new FormData();\r\n    form.append('name', document.getElementById('name').value);\r\n    form.append('email', document.getElementById('email').value);\r\n    form.append('photo', document.getElementById('photo').files[0]);\r\n    console.log(form);\r\n    updateSettings(form, 'data');\r\n  });\r\n}\r\n\r\nif (userPasswordForm) {\r\n  userPasswordForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--savePassword').textContent = 'updating...';\r\n    const passwordCurrent = document.getElementById('password-current').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('password-confirm').value;\r\n    await updateSettings(\r\n      { passwordCurrent, password, passwordConfirm },\r\n      'password'\r\n    );\r\n    document.querySelector('.btn--savePassword').textContent = 'Save password';\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n}\r\n\r\n// type is either password or data\r\nconst updateSettings = async (userInfoObj, type) => {\r\n  try {\r\n    const url =\r\n      type === 'password'\r\n        ? 'http://127.0.0.1:3000/api/v1/users/updateMyPassword'\r\n        : 'http://127.0.0.1:3000/api/v1/users/updateMe';\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url: url,\r\n      data: userInfoObj,\r\n      withCredentials: true,\r\n    });\r\n    if (res.data.status === 'success') {\r\n      console.log(res.data);\r\n      showAlert('success', `${type} updated successfully`);\r\n      location.reload();\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', 'Error while updating');\r\n  }\r\n};\r\n"]}